# Service Quirks
# Known behaviors, workarounds, and tribal knowledge about services
# Updated by agents when they discover new patterns

last_updated: null

services:
  tower-analytics-api:
    description: "Main API service for Automation Analytics"
    deployments:
      - tower-analytics-clowdapp-api
    quirks:
      - name: "Slow startup on cold start"
        description: "First request after pod restart can take 10-15s due to Django startup"
        workaround: "Check readiness probe logs, wait for ready state"
        learned: null

      - name: "High memory under load"
        description: "Memory can spike during large report generation"
        workaround: "Monitor memory, pods may OOM during heavy reporting"
        learned: null

  tower-analytics-worker:
    description: "Celery worker for background tasks"
    deployments:
      - tower-analytics-clowdapp-worker
    quirks:
      - name: "Task queue backlog"
        description: "Queue can back up if worker pods are restarting"
        workaround: "Check celery queue depth in Prometheus"
        learned: null

  tower-analytics-scheduler:
    description: "Celery beat scheduler"
    deployments:
      - tower-analytics-clowdapp-scheduler
    quirks:
      - name: "Single replica only"
        description: "Scheduler must run as single replica to avoid duplicate tasks"
        workaround: "Never scale above 1 replica"
        learned: null

# Add new quirks when discovered:
# Example:
#   - name: "Description of quirk"
#     description: "What happens"
#     workaround: "How to handle it"
#     learned: "2024-12-21"
#     jira: "AAP-XXXXX"  # Optional link to related issue
